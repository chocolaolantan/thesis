\documentclass[11pt,a4j,notitlepage]{jreport}
\usepackage[dvipdfmx]{graphicx}     %図を表示するのに必要
\usepackage[dvipdfmx]{color}        %jpgなどを表示するのに必要
\usepackage{amsmath,amssymb}        %数学記号を出すのに必要
\usepackage{setspace}

%PDFの機能(しおり機能、ハイパーリンク機能)が使えるようにする
%しおりの文字化けを防ぐ
\usepackage{atbegshi}
\AtBeginShipoutFirst{\special{pdf:tounicode 90ms-RKSJ-UCS2}}
%hyperrefのverが2007-06-14 6.76i以前の時は↓
%\AtBeginShipoutFirst{\special{pdf:tounicode 90ms-RKSJ-UCS2}}
\usepackage[dvipdfmx,bookmarkstype=toc,colorlinks=true,urlcolor=blue,linkcolor=blue,
citecolor=blue,linktocpage=true,bookmarks=true,setpagesize=false,
pdftitle={word2vecにより得たベクトルデータの利用に関する実験},
pdfauthor={平田泰樹},%
pdfsubject={Bachelor's thesis in 2016(2016年の学士論文という意味!)}]{hyperref}
\usepackage[numbers,sort]{natbib}
\usepackage{tocbibind}%目次、表一覧、図一覧をしおりに入れる
 \usepackage{ascmac}
\usepackage{fancybx}
%式、図、表番号の付け方の再定義
\makeatletter
    \renewcommand{\theequation}{%
    \thesection.\arabic{equation}}
    \@addtoreset{equation}{section}
    \def\thefigure{\thesection.\arabic{figure}}
    \@addtoreset{figure}{section}
    \renewcommand{\thetable}{%
    \thesection.\arabic{table}}
    \@addtoreset{table}{section}
\makeatother

\renewcommand\bibname{参考文献}         %関連図書->参考文献
\newcommand{\figref}[1]{図~\ref{#1}} %図1等の定義

%大きなフォントの定義(表紙用)
\def\HUGE{\fontsize{32pt}{36pt}\selectfont} %\fontsize{フォントの大きさ}{baselineskip}

%ここから本文
\begin{document}
%
%ここに本文が入る
%題名
\begin{titlepage}
\begin{center}\begin{LARGE}
\vspace*{3.5em}{平成28年度　卒業論文}\vspace{1em}\\
\textbf{\HUGE word2vecにより得たベクトルデータの利用に関する実験}\\
\vspace{0.8em}
{\LARGE\bf Analyzing Motion \\from Myogenic Potential Signal}
\vspace{0.28\vsize}\\
{北海道大学 工学部　情報エレクトロニクス学科\\コンピューターサイエンス専攻 知識ベース研究室}\\\vspace{0.8em}
{\Huge\bf 平田　泰樹}\\
\vspace{1em}
{\Large 2017年2月}
\end{LARGE}\end{center}
\end{titlepage}

\pagenumbering{roman}   %目次のページはローマ数字
\tableofcontents

\chapter{はじめに}
\pagenumbering{arabic}  %本文についてはアラビア数字(この命令は必要)
\section{研究の背景・目的}
SNSなどのサービスが普及し、世界中の人の言葉や、それに込められた思想がインターネット上にあふれるようになった。この膨大なテキストデータは、その人の趣向、動向、人と為りを知る手掛かりとなるものであるが、あふれるデータのすべてを人手で解析し、まとめることは非常に困難である。そこで、計算機を利用してこのテキストデータを処理することがさまざまな分野で考えられている。どのようにして、用途に合わせた有用な情報を取り出すかと言ったことも、今も重要な問題として挙げられる。
テキスト情報からの有用な情報抽出にはどのような分野があるか。



\section{本論文の構成}
 本論文では筋肉レベルでの解析を行うために筋電センサーを持ちた動作実験・メタ認知的な解析をするために書き取りによる実験を行った。\\
第2章では筋肉レベルでの解析を行うためにおこなった処理、特に筋電位の定量化と正規化についてと得られた結果・考察について述べた。
第3章ではメタ認知的な解析についてその結果の考察をまとめた。
第4章では両方の結果からの考察を最後のまとめとして結論をまとめた。
最後に第5章では今後の展望について現在考慮していることを述べて最後のまとめとした。

\chapter{筋肉レベルからの解析}
筋肉レベルの解析を行うために筋電センサーを用いて筋電位を測る。筋電位とは、筋肉が動いた際に生じる電圧のことである。筋電位には次のような特徴がある。\\
・加える力に比例し振幅が変化\\
・動作の変化がなくとも力を加えていれば発生する\\
   これらの特徴から筋肉の働くタイミング・加えられる比重・目に見えない動きなどの差異が検出できる可能性がある。この筋電位を縦軸として横軸に時間を置いたグラフを筋電図という。

\section{計測機器}
本実験で用いた道具について
本実験で用いたバドミントン用具は\\
シャトル：MAVIS　40 (YONEX社)\\
ラケット：B-6000 ISOMETRIC (YONEX社)\\
データを得るための機器は\\
ビデオカメラ：スポーツコーチングカム（ロジカルプロダクト）\\
筋電センサー：ワイヤレス筋電センサ（乾式）（ロジカルプロダクト）\\
加速度センサー：小型９軸ワイヤレスモーションセンサ（ロジカルプロダクト）\\
\\
\section{筋電位の計測実験の設定}
今回実験の被験者の設定を２０代男性・身長１７０cm前後の６人と設定した（以降被験者A～F）。なお被験者A・Bを上級者（中学高校部活経験者）、C・Dを中上級者（サークル活動等趣味程度）、E・Fを中初級者（球技経験者）、G・Hを初級者（学校の授業程度）とし、レベル分けを行った。\\
　筋電センサーの設置個所は、右肩・右前腕の表裏（前腕屈筋群・前腕伸筋群）・右上腕の表裏（上腕二頭筋・上腕三頭筋　図2.2.1）・広背筋右左・腹筋・腹斜筋左右、以上１０か所である。筋電センサーの電極を避けるように両面テープを張った後に皮膚上に設置し、スポーツ用テーピングで上から一周巻いた。なお、体幹に設置したセンサーについては、明らかに動きによる皮膚のしわ等によって筋電センサーが浮いてしまう場合がある。そのために下図の図2.2.2に示すように腰用圧迫固定サポーターを用いた。また、手首に一か所加速度センサーを設置した。
\begin{figure}[htbp]
\begin{minipage}{0.5\hsize}
\begin{center}

\includegraphics[width=70mm]{ude.jpg}
\caption{右腕のセンサー設置}
\end{center}
\end{minipage}
\begin{minipage}{0.5\hsize}
\begin{center}
\includegraphics[width=70mm]{kosimaki.jpg}
\caption{体幹のセンサーの固定}

\end{center}
\end{minipage}
\end{figure}


動作実験は実際にバドミントンのシャトルを被験者の前方5mの位置に設置した的めがけて打つ動作を一人５回行った。

\section{結果得られた筋電図データとその分析のために}　
この実験で得られた筋電図について、以下の図2.3.1,図2.3.2は被験者Bと被験者Cの前腕表部分から得られた筋電図である。なお、筋電位とは電気信号であるから負の値も出てくる。また他にも皮膚状態などによる環境要因のためにデータを以下のような方法で定量化・正規化を用いる。

\begin{figure}[htbp]
\begin{minipage}{0.3\hsize}
\begin{center}
\includegraphics[width=40mm]{B.jpg}
\caption{Bの前腕屈筋群の筋電図}
\end{center}
\end{minipage}
\begin{minipage}{0.3\hsize}
\begin{center}
\includegraphics[width=40mm]{C.jpg}
\caption{Cの前腕屈筋群の筋電図}
\end{center}
\end{minipage}
\begin{minipage}{0.3\hsize}
\begin{center}
\includegraphics[width=40mm]{absB.jpg}
\caption{図2.3.1の筋電図加工後}
\end{center}
\end{minipage}
\end{figure}

\subsection{筋電位の定量化方法}
まず先にも述べたが、筋電位は電気信号であるからその値の絶対値をとる。また、データに含まれてしまうノイズや特異点の緩和をするために
これは
平均をとることでおこなわれる。\\
本研究では50msecの移動平均をとることでおこなわれた。\\
\subsection{データ振幅の正規化}
これにはいくつか専攻研究として方法がある。
まず振幅の正規化について\%MVC(Maximum Voluntary Constractoin)を用いる手法がある。これは次のような式で表される。

\[
\%MVC=\frac{|得られたデータ| }{|最大筋力発揮時の値|}\times 100
\]

　最大筋力を発揮させている際に発生している筋電位との相対値を用いて比較することによって、個人差を減らして比較することができる。また同様に活動に際しての筋力量もまた得られる。\\
しかし本実験では主に筋肉が働くタイミングに注目しているため、これは用いずただ得られたデータの最大値で相対値を求めるにとどめた。最大時の筋活動レベルとの兼ね合いは今後の課題としたい。\\
次に時間の正規化についてこれには動的時間伸縮法がある。

\subsection{動的時間伸縮法}

データ数はモーションを行う際の腕をどれだけ大きく動かしているかやスイングスピードの違い、シャトルをヒットさせる高さなどの要因に依存し、異なってくる。これを解消するために、つまり異なる長さの時系列データをつまり今回の実験では実験データの時間的差異を解消するために、DTW(Dynamic Time Warping , 動的時間伸縮法)を用いた。\\
DTWの１次元パターン間でのアルゴリズムは以下のとおりである。[3]\\

２つの１次元パターン X=$x_1, x_2,...,x_N$　と　Y=$y_1,y_2,...,y_M$について、
Xのn番目の要素$x_n$とYのm番目の要素$y_m$との対応付け$u_n=m$を最適化する問題である。
要素間の対応付けの局所距離
\[
d_i(u_i)=||x_{u_i}-y_i||
\]

について最適化問題は次のようにできる。
\[
minimize\hspace{2cm}F = \min \sum_{i=0}^N d_i(u_i)
\]

\[
w.r.t\hspace{2cm}u_1,...,u_N
\]
\[
u_1 = 1 , 0 \leq u_i - u _{i-1} \leq 2 , u_N = M
\]
これらは
$u_iはu_{i-1}より小さくならない（単調性）また大きくなりすぎない（連続性）$
$倍以上の速度変化を許さないかつ始端・終端を合わせる$
という条件である。

さらにこれは次のように表現できる。

\[
\begin{split}
\min F&= \min_{\substack{u_1,...,u_N  \\ 0\leq u_i-u_{i-1} \leq 2}} \sum_{i=1}^N d_i (u_i)\\
     &=\min_{\substack{u_2,...,u_N  \\ 0\leq u_i-u_{i-1} \leq 2}}\sum_{i=3}^N \biggl[ d_i (u_i) \\
     &\quad +\{ d_2(u_2)+\min_{\substack{u_i \\0\leq u_2 - u_1 \leq 2}}d_1(u_1) \} \biggr]
\end{split}
\]
ここで右辺の\{\}内を
\[
g_2(u_2)=d_2(u_2)+\min_{\substack{u_i \\0\leq u_2 - u_1 \leq 2}}d_1(u_1)
\]
とすれば
\[
\min_{\substack{u_2,...,u_N  \\ 0\leq u_i-u_{i-1} \leq 2}}\sum_{i=3}^N \biggl[  d_i (u_i)+g_2(u_2) \biggr]
\]
$とすることができ制御変数u_1を消去することができる。同様のことを繰り返すことでつまり$
\begin{equation}
g_i(u_i)=d_i(u_i)+\min_{\substack{u_i-1\\0\leq u_i-u_{i-1} \leq 2}}g_{i-1}(u_{i-1})
\end{equation}
を繰り返し計算することによって変数の消去をすることができ、最後には

\[
\min F = \min_{u_N} g_N(u_N)
\]

として求めることができる。
式(2.3.1)はDP漸化式と呼ばれ、DPマッチング（DTW）の基本式となる。これをi=1からi=Nまで順にすべてのmについて求めることにより最適解が得られるようになっている。つまり処理は探索幅M、深さNの幅優先探索であるから計算量はO(NM)となる。\\
さてこの式から得られるものは、時系列データを最適マッチングした際のDP距離である

%これを手首に１か所設置した加速度センサーから得られる手首の位置情報からスイングの段階（構えた位置、最高打点の位置、振り切った位置）を推定し、その変化を表したグラフに対してこれを用いようと考えた。得られたグラフがなされたのと同様の割合で筋電図を横軸を変化させることにより、同じ時系列の筋電図が得られるものとする。\\
%さて手首付近に付けた加速度とビデオデータから構えた状態図2.3.4から図2.3.7までの状態に至るまでのデータを抜き出し、DTWを用いた。
%しかし、DTWのウィークポイントとして計算量が多くなってしまう問題がある。この問題を解消するために動作を2分割し、それぞれの段階ごとに分割して考えることとする。段階は以下の通りである。\\
%段階1.開始の合図を待つ状態から肘を引きシャトルを待つ\\
%段階2.肘から腕を出しいてスイングする

\begin{figure}[htbp]
\begin{minipage}{0.22\hsize}

\includegraphics[width=25mm]{1_1.jpg}
\caption{開始時}

\end{minipage}
\begin{minipage}{0.22\hsize}

\includegraphics[width=25mm]{1_2.jpg}
\caption{肘を引く}

\end{minipage}
\begin{minipage}{0.22\hsize}

\includegraphics[width=25mm]{1_3.jpg}
\caption{最高地点}

\end{minipage}
\begin{minipage}{0.22\hsize}

\includegraphics[width=25mm]{1_4.jpg}
\caption{振り切る}

\end{minipage}
\end{figure}
$DTWによって二つのデータのDP距離（式2.3.2の\min F）が得られる。$
\\
さてここまで筋電図についての特徴や、筋電図の因子解析について述べたがこれらから何が検証できるのかを考えた際に次のような仮説を立てられる。\\
仮説１:初級者は力を抜くところを抜けていない\\
これについては筋電図の量的因子から見て力が生じている状態が時間的因子から見て時間変化を検出できれば証明できる。\\
仮説２:うまい人はどこかのタイミングで初級者が使っていない力を働かせている\\
二つの長さの異なる時系列データをマッチングさせる方法DTWを用いて局所距離を求めることで差異が生じる時間を検出できる。\\
仮説3:インパクト（最も力を加える）タイミングが異なる。


\section{結果の考察}
まずは得られた筋電図について
\begin{figure}[htbp]

\begin{center}

\includegraphics[width=100mm]{Barm.jpg}
\caption{被験者Bの腕の筋電図}
\end{center}

\begin{center}
\includegraphics[width=100mm]{Bbody.jpg}
\caption{被験者Bの体幹の筋電図}

\end{center}

\end{figure}

\begin{figure}[htbp]

\begin{center}

\includegraphics[width=100mm]{Carm.jpg}
\caption{被験者Cの腕の筋電図}
\end{center}

\begin{center}
\includegraphics[width=100mm]{Cbody.jpg}
\caption{被験者Cの体幹の筋電図}

\end{center}

\end{figure}\begin{figure}[htbp]

\begin{center}

\includegraphics[width=100mm]{Harm.jpg}
\caption{被験者Hの腕の筋電図}
\end{center}

\begin{center}
\includegraphics[width=100mm]{Hbody.jpg}
\caption{被験者Hの体幹の筋電図}

\end{center}

\end{figure}
次にDTWを用いたことで得られた各筋肉ごとのDP距離
\begin{table}[htb]
\label{tab:meta}
\begin{tabular}{|r||r|r|r|r|r|}\hline
被験者　&前腕屈筋群&前腕伸筋群&上腕二頭筋&上腕三頭筋&三角筋\\ \hline\hline
C&3.43661&1.37025&2.97792&1.43958&5.33601\\ \hline
H&3.97472&0.872215&1.90492&7.74252&6.08165\\ \hline
\end{tabular}
\caption{被験者BとのDP距離（腕）}
%\label{tab:meta}
%\begin{tabular}{|r||r|r|r|r|r|}\hline
%被験者　&右腹斜筋&左腹斜筋&腹筋&右広背筋&左広背筋\\ \hline\hline
%C&1&1&0&0&0\\ \hline
%G&1&0.5&0.5&0&4.80904\\ \hline
%\end{tabular}
%\caption{被験者BとのDP距離（体幹）}
\end{table}
このDP距離の表から、被験者Bと被験者Cでは三角筋の使い方が最も他の筋肉の使い方からことなった筋肉の使い方をしていることが分かる。同様に被験者Bと被験者Hでは上腕三頭筋の使い方が最も異なると推定される。
よって仮説の2については被験者Bは三角筋の使い方が、一つ下の上達段階の人間と最も異なる働きをしていると推定できる。\\
ここでDTWについて、対応付けが完成していた場合には動作の段階ごとに振幅がどれだけ異なっていたのかをかく時間ごとに求めることができるようになる。



\chapter{メタ認知的な側面からのアプローチ}
メタ認知とは自分が何をしているのかを客観的に理解するということである。\\
\begin{screen}
本来言語化することは難しい”身体知”（体に覚えさせる重要な”知”）を敢えて言語化しようとする試みが、身体知の獲得を促進する。
\end{screen}
という仮説から、言語化は身体知獲得、つまりは動作上達の有効なツールの一つであると考える[]。
\\
本研究ではメタ認知の解析として、動作実験後の書き取りによるメタ認知の言語化を行うこと身体知の獲得をめざした解析を行った。これはつまり一つ上の動作上達の段階にいる人の意識するポイントから、意識するべき筋肉を特定し身体知獲得の手助けをすることを目指した分析をおこなう。\\

\section{メタ認知的なデータの取得実験の設定}
実験後に被験者に質問用紙(付録B)を渡し、そのデータをもとに被験者の意識している体の部位の各レベルでの移り変わりを検出することを目指した。この質問用紙は、初級者・中級者のようなこの動作について持っている語彙力の少なさを補助するために用意した。

\section{結果と考察}
\begin{table}[htb]
\label{tab:meta}
\begin{tabular}{|r||r|r|r|r|r|r|r|r|}\hline
被験者　&手首&肘&肩&胸筋&腹筋&背筋&腰&足\\ \hline\hline
A&1&0&0&0&0&0&1&1\\ \hline
B&1&0&1&0.5&1&0&1&1\\ \hline
C&1&1&0&0&0&1&1&1\\ \hline
D&1&0&1&0.5&1&0&1&1\\ \hline
E&1&1&1&0&0&0&0&1\\ \hline
F&0&0&0&0&0&0&0&1\\ \hline
G&1&0.5&0.5&0&0&0&1&0.5\\ \hline
H&0&1&1&0&0&0&0&1\\ \hline

\end{tabular}
\caption{メタ認知　1:意識,0.5:少し意識,0:完全に無意識}
\end{table}

この結果、 表3.2.1についてはデータ数が少ないために言えることが少ないが、初級者は腕に対して意識が集中していることが分かり、中級者レベル以上になると体幹に対しても意識が向けられるようになっていることが分かるが、上級者ではまた再び意識をしなくなってきている。これは無意識化でもうまい上体の筋肉の使い方ができるようになっていることが分かる。\\

また同様に解答用紙に書かれた文字数についてもやはり初級者は自分が実験でおこなった動作に対しての言語化ができないために少なく、中級者以上ではスイングについての指導をコーチもしくは友人からの指導を受けたことがあるためか増えていた。\\
データ数を増やし、さらなる信頼度のおけるような分析は今後の課題としたい。


\chapter{結論・まとめ}
筋肉レベルでの解析として、筋電位の解析をおこない、メタ認知的な解析として言語化実験を行ってきたが、結論としては筋電図とメタ認知の結果からは整合性がけんしゅつすることができなかった。そもそもが、メタ認知的な”気づき”の導出には大いに時間がかかり、また本実験では圧倒的にデータ数が不足していた。本実験ではいろいろな不手際があったことは否めないが、筋電位を利用した動作解析の入り口には立てたように思われる。また、データから見てとれることの考察も不足しているが、今後データ数を増やし様々な動作について今後解析を行いたい。


\chapter{今後の展望}
今後の展開として、本研究では実装していない\%MVCを利用した負担度評価[3]を考慮したスポーツ技術の評価について考えている。これにより筋電図の振幅についてもより深く利用した研究ができるであろうことが予想できる。また同様に
メタ認知は学習・トレーニングに主に用いられてきた。 メタ認知を持ちた習得には次の段階を経て行う[5]。\\
1.行動を試行する\\
2.行動・その時の思考を思い起こし、思ったことや気づいたことを言語化して書き留める\\
3.”気付き”を得える。\\
4.次の行動へ生かす\\
この4段階を繰り返すことによって動作の上達を目指す。これには多大な時間がかかる。\\
　そこで通常の場合は、人からの助言をもとに上達を早めていくわけである。このことから、動作実験を上級者に見てもらい外部から客観的に見た動きからの助言を”メタ認知的気づき”として動作上達のために次の行動へ生かす。このときどれだけデータに変化が生じるであろうか。そのことを利用した動作上達の方法など、情報の分野からできるアプローチを検証し、活用されることが期待される。

また、解析方法として使用したDTWについて本研究ではDP距離を求めるところまでの実装しかできなかったので、今後その対応付けを求められるように拡張すること、および多次元のマッチングについてもおこなえるようにすることを今後の課題としたい。

同様に順運動学、逆運動学についての理解を深め、トルクなどの力学的な知識を研究に組み込むことを目標とする。本研究はデータをとる過程の計測方法の取得に大いに時間がかかってしまったために結論・考察が不足したものとなってしまったが、今後の課題や発展のために必要となるであろう事柄を数多く得ることができた


\appendix




\def\thesection{A\Alph{section}}
\chapter{メタ認知実験に用いた回答用紙}
実験データ\\
メタ認知実験\\
被験者番号　No.\\
以下の体の部分または因子について実験中何か意識していたことがありましたらできるだけ具体的にお答えください。とくに考えてない場合は無意識とお答えください。\\
Q1　目線\\\\
Q2　ラケットの面\\\\
Q3　手首\\\\
Q4　肘　\\\\
Q5　肩\\\\
Q6　胸筋\\\\
Q7　腹筋\\\\
Q8　背筋\\\\
Q9　腰\\\\
Q10　足\\\\
Q11 その他\\\\
最後にご自身のスポーツ経験をお書きください。\\




\def\thesection{C\Alph{section}}

\chapter*{謝辞}
\addcontentsline{toc}{chapter}{謝辞}
本研究のために多大なるご助言をいただきました原口先生をはじめとした研究室の先生方や本研究に協力いただきました被験者の皆さまには多大なるご迷惑とご苦労をおかけしてしまいました。また、私の不足した知識に最後までお付き合いくださり指導してくださった先生方には心より感謝しております。本研究は協力いただきましたすべての方々のおかげで、形を成すことができております。寒い中を薄着になってデータをとらせてくれた被験者の皆さま、初めて書く論文に悩み苦しむ私にアドバイスをくださいました研究室の先輩方、数多くの方々の協力をいただき誠にありがとうございました。ここに深く感謝申し上げます。


\chapter*{参考文献}
\addcontentsline{toc}{chapter}{参考文献}
[1]加藤　礼菜　Chest Hooping習得過程の分析　日本大学文理学部　(2015)

[2]堀　浩　筋電図の手引き　南山堂　(1984)

[3]松本　和弘　大本浩司　表面筋電図を用いたぺだリング運動時における負担度評価　Evaluation of load during pedaling exercise using surface EGM 技術論文

[4]内田　誠一　DPマッチング概説～基本と様々な拡張～　社団法人　電子情報通信学会　（2006-12）

[5]諏訪　正樹　身体知獲得のツールとしてのメタ認知的言語化　スキルサイエンス
中央大学情報科学部

[6]R.E.シュミット/G.テウス　編　佐藤　昭夫　監訳　スタンダード人体生理学  シュプリンガー・フェアラーク東京（1994）


\end{document}
